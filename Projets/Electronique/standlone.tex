
%#############################################################
%MAIN file for  project
%#############################################################
\documentclass[12pt]{report}
%############################################################
%###### Package 'Adding' 
%###### This package contains some tools to generate index, glossary
%###### nomenclature, acronym
%###### Author  : Nicolas LE GUERROUE
%###### Contact : nicolasleguerroue@gmail.com
%############################################################
%\ProvidesPackage{Utils}[2013/01/13 Utils Package]
%############################################################
%##### Glossaries
\RequirePackage[xindy, acronym, nomain, toc]{glossaries}
\RequirePackage{ifthen} 
\RequirePackage{nomencl}  %nomenclature
\RequirePackage{lmodern}
\RequirePackage[T1]{fontenc}
\RequirePackage[utf8]{inputenc}     %UTF-8 encoding
\RequirePackage{graphicx}           %Images
\RequirePackage{caption}            %légende
\RequirePackage{textcomp}           %special characters

\RequirePackage{lastpage}           %page counter
%\RequirePackage{fullpage}          %entire page
\RequirePackage{float}              %image floating
\RequirePackage{wrapfig}
\RequirePackage{subcaption}         %Subcaption
\RequirePackage{listings}           %new env such as Bash, Python
%\RequirePackage{tcolorbox}          %messageBox
\RequirePackage[many]{tcolorbox}
\RequirePackage{color}              %colors
\RequirePackage{geometry}
\RequirePackage{listings}           %new env such as Bash, Python
\RequirePackage{xcolor}             %define new colors
\RequirePackage{xparse}
\RequirePackage{amssymb,amsthm}     %math
\RequirePackage{multirow}
\RequirePackage{tabularx}           %use for csv file [table]

\RequirePackage{bookmark}           %use for hyperref
\RequirePackage{makeidx}            %make index

\makeindex
\makeglossaries
\makenomenclature

%##### Convention [Nomenclature]
  \renewcommand{\nomgroup}[1]{%
  \item[\bfseries
  \ifthenelse{\equal{#1}{P}}{Constantes physiques}{%
  \ifthenelse{\equal{#1}{O}}{Autres symboles}{%
  \ifthenelse{\equal{#1}{N}}{Nombres spéciaux}{ 
  \ifthenelse{\equal{#1}{A}}{Amplificateurs Opérationnels}{ 
  \ifthenelse{\equal{#1}{M}}{Mécanique}{ 
  \ifthenelse{\equal{#1}{E}}{Électronique}{}}}}}}%
  ]}

  \renewcommand{\glossary}[1]{%
  \gls{#1}
}
% Add unit on convention [nomenclature]
%----------------------------------------------
\newcommand{\addUnit}[1]{%
\renewcommand{\nomentryend}{\hspace*{\fill}#1}}
%----------------------------------------------%############################################################
%###### Package 'name' 
%###### This package contains ...
%###### Author  : Nicolas LE GUERROUE
%###### Contact : nicolasleguerroue@gmail.com
%############################################################
\RequirePackage{lmodern}
\RequirePackage[T1]{fontenc}
\RequirePackage[utf8]{inputenc}     %UTF-8 encoding
\RequirePackage[many]{tcolorbox}
%...

%1 : txt color
%2 : bg color 
%3 : text
\newtcbox{\badge}[3][red]{
  on line, 
  arc=2pt,
  colback=#3,
  colframe=#3,
  fontupper=\color{#2},
  boxrule=1pt, 
  boxsep=0pt,
  left=6pt,
  right=6pt,
  top=2pt,
  bottom=2pt
}

%################################################################%############################################################
%###### Package 'Chapter_1' 
%###### This package contains first model of chapter
%###### Author  : Nicolas LE GUERROUE
%###### Contact : nicolasleguerroue@gmail.com
%############################################################
% \RequirePackage[explicit]{titlesec} 


% \titleformat{\chapter}
%   {\gdef\chapterlabel{}
%    \normalfont\sffamily\Huge\bfseries\scshape}
%   {\gdef\chapterlabel{\thechapter)\ }}{0pt}
%   {\begin{tikzpicture}[remember picture,overlay]
%     \node[yshift=-2cm] at (current page.north west)
%       {\begin{tikzpicture}[remember picture, overlay]
%         \draw[fill=MediumBlue] (0,0) rectangle
%           (\paperwidth,2cm);
%         \node[anchor=east,xshift=.9\paperwidth,rectangle,
%               rounded corners=20pt,inner sep=11pt,
%               fill=white]
%               {\color{black}#1};%\chapterlabel
%           \node[anchor=west,yshift=1cm,xshift=2cm,inner sep=11pt,
%               fill=MediumBlue]
%               {\color{white}{\large Synthèse Latex}};%\chapterlabel
%        \end{tikzpicture}
%       };
%    \end{tikzpicture}
%   }
%   \titlespacing*{\chapter}{0pt}{50pt}{-60pt}%############################################################
%###### Package 'Citations' 
%###### This package contains some tools to set quotes
%###### Author  : Nicolas LE GUERROUE
%###### Contact : nicolasleguerroue@gmail.com
%############################################################
\RequirePackage{cite}
\RequirePackage{epigraph}
\RequirePackage{quotchap}
%################################################################

% \@ifclassloaded{report}{
\newcommand{\addQuote}[2]{
   \epigraph{\textit{\og #1 \fg{}}}{#2}
}
% }%############################################################
%###### Package 'Color' 
%###### This package contains some colors
%###### Author  : Nicolas LE GUERROUE
%###### Contact : nicolasleguerroue@gmail.com
%############################################################
\RequirePackage{color}              %colors
%################################################################
\definecolor{pathColor}{rgb}{0.858, 0.188, 0.478}
\definecolor{fileColor}{rgb}{0.858, 0.188, 0.478}
\definecolor{water}{rgb}{0.858, 0.188, 0.478}
\definecolor{LightBlue}{RGB}{66, 163, 251}
\definecolor{DarkBlue}{RGB}{36, 100, 176}
\definecolor{LightGray}{gray}{.94}
\definecolor{DarkGray}{gray}{.172}
\definecolor{Orange}{RGB}{229, 133, 3}
\definecolor{MediumBlue}{RGB}{38, 119, 193}


\newcommand{\colors}[2]{
{\color{#1}{#2}}
}


%------------------Section Default Setting-------------%############################################################
%###### Package 'Electronic' 
%###### This package contains some tools to generate electornic circuits
%###### Author  : Nicolas LE GUERROUE
%###### Contact : nicolasleguerroue@gmail.com
%############################################################

\RequirePackage{tikz-timing}

\RequirePackage{graphics} %include figures
\RequirePackage{graphicx} %include figures
\RequirePackage{pgf,tikz}
\RequirePackage{circuitikz}
\usetikzlibrary{babel}  %allow to use tikz library with babel

\RequirePackage{ifthen}    %use if then 
 

%############################ Settings ##############################
\tikzset{%
    timing/table/axis/.style={->,>=latex},
    timing/table/axis ticks/.style={},   
}

%Direction of some device such as resistor, led...
%1.5 is the minimum length of device according my runs
\newcommand{\Up}{0,1.5}
\newcommand{\Down}{0,-1.5}
\newcommand{\Right}{1.5,0}
\newcommand{\Left}{-1.5,0}


%###### Length of components
\newcommand{\bipolesLength}[1]{#1cm}     %begin default size
%Length update
\newcommand{\setBipolesLength}[1]{
    \renewcommand{\bipolesLength}{#1}
    \ctikzset{bipoles/length=\bipolesLength cm}
}%End \setBipolesLength

%############ Mirrors and inverting
\newcommand{\Mirror}{}
\newcommand{\Invert}{}

%Update
\newcommand{\setMirror}[1]{
    \renewcommand{\Mirror}{,mirror}
}%End \setMirror

\newcommand{\setNoMirror}[1]{
    \renewcommand{\Mirror}{}
}%End \setMirror

\newcommand{\setInvert}[1]{
    \renewcommand{\Invert}{,Invert}
}%End \setInvert

\newcommand{\setNoInvert}[1]{
    \renewcommand{\Invert}{}
}%End \setInvert


%############## Rotate ###########
\newcommand{\rotate}{0}

%Update
\newcommand{\setRotate}[1]{
    \renewcommand{\rotate}{#1}
}%End \setRotate


%####################### Colors
%default colors of border colors and background colors
\newcommand{\deviceBorderColor}{black}
\newcommand{\deviceBackgroundColor}{white}

%Update
\newcommand{\setDeviceBorderColor}[1]{
    \renewcommand{\deviceBorderColor}{#1}
    \renewcommand{\deviceBackgroundColor}{white} %reset bg color
}%End \setDeviceBorderColor

\newcommand{\setDeviceBackgroundColor}[1]{
    \renewcommand{\deviceBorderColor}{black} %reset bg color
    \renewcommand{\deviceBackgroundColor}{#1}
}%\setDeviceBackgroundColor

%Reset
\newcommand{\resetColors}{
    \renewcommand{\deviceBorderColor}{black} %reset border color
    \renewcommand{\deviceBackgroundColor}{white} %reset bg color
}
%####################################################################
%############## draw device #########################################

%rotation
%color
%anchor

%\ifthenelse{\equal{#1}{0}}{A.}{no A.}
%Init

\begin{comment}
    @begin
    @command \addLogicGate
    @des 
    Cette commande permet de dessiner une porte logique à double entrée. Pour dessinder une porte inverseuse, utiliser la commande \addNotGate
    @sed
    @input Coordonnées de la porte en (x,y) sans parenthèse
    @input Référence de la porte pour s'accrocher aux entrées et sorties
    @input Type de la porte [nand, nor, or, and, or, xor]
    @input Label de sortie (laisser vide si absence de label souhaité)
    @input Label de l'entrée 1 (laisser vide si absence de label souhaité)
    @input Label de l'entrée 2 (laisser vide si absence de label souhaité)
    @input Nom de la porte [NOR1, AND1...]
    @begin_example 
    \addLogicGate{5,5}{logicgate}{nand}{S}{A}{B}{L1}
    @end_example
    @end
    \end{comment}

\newcommand{\addLogicGate}[7] {
    %\Colors
    \ifthenelse{\equal{\deviceBorderColor}  {black}}
    {\draw (#1)         node (#2) [rotate=\rotate,xshift=0cm,fill=\deviceBackgroundColor,#3 port] {#7}}%if equal to black
    {\draw (#1)         node (#2) [rotate=\rotate,xshift=0cm,color=\deviceBorderColor,#3 port] {#7}}

    (#2.out)  node      [anchor=south west, yshift=-0.3cm] {#4}
    (#2.in 1) node (A1)     [anchor=east,xshift=0cm,yshift=+0.3cm]       {#5}
    (#2.in 2) node (B1)     [anchor=east,xshift=0cm,yshift=+0.3cm]       {#6};
}


\newenvironment{schema}[1]
{
    \begin{center}
        \makeatletter
        \def\@captype{figure}
        \makeatother
        \newcommand{\TitleSchema}{#1}%use var to print title 

        
        %\shorthandoff{:;!?} %Compulsory if frenchb package is used (from babel)
            
        \begin{tikzpicture}
            %\setGraphic %command to display with frenchb babel
    }
    { 
        \end{tikzpicture}
   % \caption{\TitleSchema}
    \end{center}
}


\newenvironment{numeric}[1]
{
\begin{center}
    \makeatletter
    \def\@captype{figure}
    \makeatother
    \newcommand{\TitleNumeric}{#1}%use var to print title 
\begin{tikztimingtable}
}
{
\end{tikztimingtable}%
\caption{\TitleNumeric}
\end{center}
}


%cood
%name device
%type (npn, pnp)
%B
%C
%E
\newcommand{\addTransistor}[6] {

    \ifthenelse{\equal{\deviceBorderColor}  {black}}
    {\draw (#1)         node (#2) [xshift=0cm,fill=\deviceBackgroundColor,#3] {}}%if equal to black
    {\draw (#1)         node (#2) [xshift=0cm,color=\deviceBorderColor,#3] {}}

    (#2.B)  node      [anchor=south west, xshift=0cm, yshift=0cm] {#4} 
    (#2.C) node (A1)     [anchor=north,xshift=0.3cm,yshift=+0.1cm]       {#5}
    (#2.E) node (B1)     [anchor=south,xshift=0.3cm,yshift=0.1cm]       {#6};
}
%node 1
%node 2
%wire type
\newcommand{\addWire}[3] {
    \draw (#1) #3 (#2);
}%end addWire

\newcommand{\orthogonalWireA}{-|}
\newcommand{\orthogonalWireB}{|-}
\newcommand{\directWire}{--}

%coord
%label
%value
\newcommand{\addNode}[3] {
    \node (#2) at (#1) {#3};
}%end addWire


%posiition (x,y)
%color
%width in pt
\newcommand{\addPoint}[3] {
    \filldraw [#2] (#1) circle (#3pt);
}%end addWire

%posiition (x,y)
%name
%value
\newcommand{\addPower}[3] {
    \draw (#1) node (#2) [vcc] {#3};
}%end addPower

%posiition (x,y)
%name
%value
\newcommand{\addGround}[3] {
    \draw (#1) node (#2) [ground] {#3};
}%end addGround

%posiition depart(x,y)
%orientation de départ
%position arrivée
\newcommand{\addResistor}[4] {
    \draw (#1) to[R,l=$R$] +(#2) #4 (#3);
}%end addResistor

%posiition depart(x,y)
%orientation de départ
%position arrivée
%type de liaison
%nom de la led
\newcommand{\addLed}[5] {
    \ifthenelse{\equal{\deviceBorderColor}  {black}}
    {\draw (#1) to[leD,l_=#5,fill=\deviceBackgroundColor] +(#2) #4 (#3);}
    {\draw (#1) to[leD,l_=#5,color=\deviceBorderColor] +(#2) #4 (#3);}

    % {\draw (#1)         node (#2) [xshift=0cm,fill=\deviceBackgroundColor,#3] {}}%if equal to black
    % {\draw (#1)         node (#2) [xshift=0cm,color=\deviceBorderColor,#3] {}}

    %\draw (#1) to[leD,l_=#5] +(#2) #4 (#3);
}%end addResistor%\LoadClass{article}%############################################################
%###### Package 'Font' 
%###### This package contains some tools to set fonts
%###### Author  : Nicolas LE GUERROUE
%###### Contact : nicolasleguerroue@gmail.com
%############################################################
\RequirePackage{fontawesome}

\newcommand{\arobase}{\faAt}

   %############################################################
%###### Package 'Graphics' 
%###### This package contains some tools to create graphics 2D or 3D
%###### Author  : Nicolas LE GUERROUE
%###### Contact : nicolasleguerroue@gmail.com
%############################################################
%\ProvidesPackage{Utils}[2013/01/13 Utils Package]
%############################################################
\RequirePackage[T1]{fontenc}
\RequirePackage[utf8]{inputenc}     %UTF-8 encoding
\RequirePackage{csvsimple} 
\RequirePackage{tikz,pgfplots,pgf}  
\RequirePackage{version}            %use commented code

\RequirePackage{graphics} %include figures
\RequirePackage{graphicx} %include figures
\RequirePackage{caption}
\RequirePackage{subcaption} %Add
\RequirePackage{version}            %use commented code
\pgfplotsset{compat=1.7}
%###### Checking if babel is loaded
\makeatletter
\@ifpackageloaded{babel}
{% if the package was loaded
\newcommand{\setGraphic}{\shorthandoff{:;!?}} %Compulsory if frenchb package is used (from babel)
\frenchbsetup{StandardLists=true} %to include if using \RequirePackage[french]{babel} -> rounded list
}
{%else:
\newcommand{\setGraphic}{} %Compulsory if frenchb package is used (from babel)
}
\makeatother
%############################################################
%### WARNING : USE \shorthandoff{:;!?} before \begin{tikzpicture} 
%### environment
%############################################################
\begin{comment}
@begin
@env graphics
@des 
Cet environnement permet de tracer des courbes en 2D à partir de points, d'équations ou de fichier CSV
@sed
@input Largeur du graphique ]0;1] 
@input Hauteur du graphique ]0;1+] 
@input Valeur minimale en abscisse 
@input Valeur maximale en abscisse
@input Valeur minimale en ordonnée 
@input Valeur maximale en ordonnée
@input Légende de l'axe des abscisse
@input Légende de l'axe des ordonnées
@input Titre du graphique
@begin_example 
\begin{graphics}{0.8}{0.5}{0}{100}{-10}{10}{ve}{vs}{Titre}
\addPointsFromCSV{raw.csv}
\end{graphics}
@end_example
@end
\end{comment}

\newenvironment{graphicFigure}[9]
{
    \begin{center}
        \makeatletter
        \def\@captype{figure}
        \makeatother

        \newcommand{\TitleGraphic}{#9}%use var to print title 
        \begin{tikzpicture}
        \setGraphic %command to display with frenchb babel
    %\shorthandoff{:;!?} %Compulsory if frenchb package is used (from babel)
    \begin{axis}[width=#1\linewidth,height=#2\linewidth,xmin=#3,xmax=#4,  ymin=#5, ymax=#6, scale only axis,xlabel=#7,ylabel=#8] %grid=both
    }
    { 
    \end{axis}
        \end{tikzpicture}
        \captionof{figure}{\TitleGraphic}
    \end{center}
}


\newenvironment{graphic}[9]
{
        %\newcommand{\TitleGraphic}{#9}%use var to print title 
        \begin{tikzpicture}
        \setGraphic %command to display with frenchb babel
    \begin{axis}[width=#1\linewidth,height=#2\linewidth,xmin=#3,xmax=#4,  ymin=#5, ymax=#6, scale only axis,xlabel=#7,ylabel=#8, title=#9] %grid=both
    }
    { 
    \end{axis}
        \end{tikzpicture}
}
    
%############################################################
\begin{comment}
@begin
@command plot
@des 
Cette commande permet de tracer des surfaces 3D
@sed
@input Iitre du graphique
@input Equation à deux variables (x et y)
@begin_example 
\plot{Titre}{x*x+y*5}
@end_example
@end
\end{comment}   
    
\newcommand{\plot}[2]{
\begin{tikzpicture}
\setGraphic %command to display with frenchb babel
 \begin{axis}[title={#1}, xlabel=x, ylabel=y]
 \addplot3[surf,domain=0:360,samples=50]
 {#2};
 \end{axis}
 \end{tikzpicture}
 }
    
%############################################################
\begin{comment}
@begin
@command addPoints
@des 
Cette commande permet de tracer une courbe en passant une liste de coordonnées de points : (x1,y1)(x2,y2)(...)
Il faut que cette commande soit utilisées dans l'environnement \textbf{graphics}.
@sed
@input Couleur de la courbe
@input Liste des coordonnées des points. Chaque point est entre parenthèse et les coordonnées sont séparées par une virgule
@begin_example 
\addPoints{red}{(0,0)(5,0)(5,5)(10,5)(10,0)}
@end_example
@end
\end{comment}   

\newcommand{\addPoints}[2]{
    \addplot+[thick,mark=none, color=#1] coordinates{#2};
}

%############################################################
\begin{comment}
@begin
@command addTrace
@des 
Cette commande permet de tracer une courbe en passant une équation en fonction de x
Il faut que cette commande soit utilisées dans l'environnement \textbf{graphics}.
@sed
@input Couleur de la courbe
@input Début du domaine de définition
@input Fin du domaine de définition
@input Équation à tracer
@begin_example 
\addTrace{blue}{4}{8}{8x^2}
@end_example
@end
\end{comment}

\newcommand{\addTrace}[4]{
    \addplot [#1, domain=#2:#3, samples=400] {#4};
}

%############################################################
\begin{comment}
@begin
@command addPointsFromCSV
@des 
Cette commande permet de tracer une courbe en passant un fichier de données CSV (ou format TXT)
Il faut que cette commande soit utilisées dans l'environnement \textbf{graphics}.
@sed
@input Couleur de la courbe
@input délimitateur des données (comma=virgule, semicolon=point-vigule)
@input Fichier des données
@begin_example 
\addPointsFromCSV{blue}{semicolon}{raw.csv}
@end_example
@end
\end{comment}

\newcommand{\addPointsFromCSV}[3]{
    \IfFileExists{#3}{
    \addplot+[thick, mark=none, color=#1] table[mark=none,col sep=#2] {#3};
    }
    {\raiseError{[import failed]'#3' \stop}
    }
}

%############################################################
\begin{comment}
@begin
@command addLegend
@des 
Cette commande permet d'ajouter une légende au graphique
Il faut que cette commande soit utilisées dans l'environnement \textbf{graphics}.
@sed
@input Légendes de chaque courbe séparées par une virgule
@begin_example 
\addLegend{sig1, sig2, sig3}
@end_example
@end
\end{comment}

\newcommand{\addLegend}[1]{
    \legend{#1}
}

%############################################################%############################################################
%###### Package 'Layout' 
%###### This package contains some tools to set page layout or text
%###### Author  : Nicolas LE GUERROUE
%###### Contact : nicolasleguerroue@gmail.com
%############################################################
\RequirePackage{lmodern}
\RequirePackage[T1]{fontenc}
\RequirePackage[utf8]{inputenc}     %UTF-8 encoding
\RequirePackage{graphicx}           %Images
\RequirePackage{caption}            %légende
\RequirePackage{textcomp}           %special characters
\RequirePackage{fancyhdr}           %headers & footers
\RequirePackage{lastpage}           %page counter

\RequirePackage{float}              %image floating
\RequirePackage{wrapfig}
\RequirePackage{subcaption}         %Subcaption

\RequirePackage{geometry}

%############################################################

\begin{comment}
@begin
@command \setHeader
@des 
Cette commande permet de créer une page de garde minimaliste
@sed
@input Titre du document
@input Auteur(s) - Les retours à la ligne se font en utilisant la commande \\
@input La date
@begin_example 
\setHeader{Titre}{Auteur 1 \\ Auteur 2}{XX/XX/XXXX}
@end_example
@end
\end{comment}

\newcommand{\setHeader}[3]{
\title{#1}
\author{#2}
\date{#3}
\maketitle
}

% \makeatletter%
% \@ifclassloaded{babel}%
%   {BABEL is LOADED}%
%   {NOT}%
% \makeatother%


%###############################################################
\begin{comment}
@begin
@command \partImg
@des 
Cette commande permet de créer une page de partie avec une image
@sed
@input Titre de la partie
@input Source de l'image \\
@input Ratio
@begin_example 
\partImg{Partie}{Images/file.png}{0.2}
@end_example
@end
\end{comment}
\newcommand{\partImg}[3]{
    \part[#1]{#1 \\\vspace*{2cm} \makebox{\centering \includegraphics[width=#3\textwidth]{#2}}}
}


%###############################################################
\begin{comment}
@begin
@command \setHeaderImage
@des 
Cette commande permet de créer une page de garde avec une image centrée, un titre, sous titre en plus
@sed
@input Titre du document
@input Auteur(s) - Les retours à la ligne se font en utilisant la commande \\
@input La date
@begin_example 
\setHeaderImage{Titre}{Auteur 1 \\ Auteur 2}{XX/XX/XXXX}
@end_example
@end
\end{comment}

\newcommand{\setHeaderImage}[6]{
\begin{titlepage}
  \begin{sffamily}
  \begin{center}
    \includegraphics[scale=#2]{#1} \sn \sn
    \hfill
%\HRule \\[0.4cm]
\begin{center}
    {\Huge \textbf{#3}} \sn
    \textbf{#4}\sn \sn
\end{center}
\sn \sn
 #5 \sn
   \vfill
   {\large #6}
  \end{center}
  \end{sffamily}
\end{titlepage}
}


%### Définition du style de page 'classic' si report

\newcommand{\addPresentation}[6]{
\fancypagestyle{classic}{
    \rhead{#3}  
    \lhead{#1}
    \chead{#2}
    \rfoot{#6}  %Page courante / Nombre de page
    \cfoot{#5}
    \lfoot{#4}
}

\@ifclassloaded{report}{
\makeatletter
\renewcommand\chapter{\if@openright\cleardoublepage\else\clearpage\fi
                      \thispagestyle{classic} %Thème 'classic'
                      \global\@topnum\z@
                      \@afterindentfalse
                      \secdef\@chapter\@schapter}
\makeatother
}%End renew chapter

\@ifclassloaded{book}{
\makeatletter
\renewcommand\chapter{\if@openright\cleardoublepage\else\clearpage\fi
                      \thispagestyle{classic} %Thème 'classic'
                      \global\@topnum\z@
                      \@afterindentfalse
                      \secdef\@chapter\@schapter}
\makeatother
}%End renew chapter

\pagestyle{classic}
}


\newcommand{\setRightHeader}[1]{\rhead{#1}}
\newcommand{\setCenterHeader}[1]{\chead{#1}}
\newcommand{\setLeftHeader}[1]{\lhead{#1}}

\newcommand{\setRightFooter}[1]{\rfoot{#1}}
\newcommand{\setCenterFooter}[1]{\cfoot{#1}}
\newcommand{\setLeftFooter}[1]{\lfoot{#1}}



\newcommand{\setHeaderLine}[1]{ 
\renewcommand{\headrulewidth}{#1pt} 
}
\newcommand{\setFooterLine}[1]{ 
\renewcommand{\footrulewidth}{#1pt} 
}
  
\newcommand{\currentChapter}{\leftmark}

%Raccourcis
\@ifclassloaded{report)}{

\newcommand{\setAliasChapter}[1]{
\makeatletter
\renewcommand{\@chapapp}{#1}   %Le mot 'Chapitre' est remplacé par 'Section'
\makeatother
}
}%End if
{
  \newcommand{\setAliasChapter}[1]{
}
}

\@ifclassloaded{book)}{
\newcommand{\currentChapter}{\leftmark}
\newcommand{\setAliasChapter}[1]{
\makeatletter
\renewcommand{\@chapapp}{#1}   %Le mot 'Chapitre' est remplacé par 'Section'
\makeatother
}
}%End if


\newcommand{\currentPage}{\thepage/\pageref{LastPage}}%############################################################
%###### Package 'name' 
%###### This package contains ...
%###### Author  : Nicolas LE GUERROUE
%###### Contact : nicolasleguerroue@gmail.com
%############################################################
\RequirePackage{lmodern}
\RequirePackage[T1]{fontenc}
\RequirePackage[utf8]{inputenc}     %UTF-8 encoding
\RequirePackage{graphicx}           %Images
\RequirePackage{caption}            %légende
\RequirePackage{float}              %image floating
\RequirePackage{wrapfig}
\RequirePackage{subcaption}         %Subcaption
%################################################################
\begin{comment}
    @begin
    @command \img
    @des 
    Cette commande permet de mettre une image centrée avec un titre et une taille
    @sed
    @input Source et nom de l'image
    @input Titre de l'image
    @input Taille de l'image ]0;1+]
    @begin_example 
    \img{Image.png}{Titre de l'image}{0.5}
    @end_example
    @end
  \end{comment}
    
    \newcommand{\img}[3]{\IfFileExists{#1}{\begin{figure}[H]\centering\ \includegraphics[scale=#3]{#1}\caption{#2}\end{figure}}{\raiseWarning{[import failed]'#1'}}}

    %\newcommand{\imgd}[3]{\IfFileExists{#1}{\begin{figure}[H]\centering\ \includegraphics[scale=#3]{#1}\caption{#2}\end{figure}}{\raiseWarning{[import failed]'#1'}}}
    
    %################################################################
    \begin{comment}
    @begin
    @command \imgf
    @des 
    Cette commande permet de mettre une image centrée avec un titre et une taille de manière flottante avec le contenu
    @sed
    @input Source et nom de l'image
    @input Titre de l'image
    @input Taille de l'image ]0;1+] par rapport au texte
    @input Taille de l'image par rapport à l'espace qui lui est reservé
    
    @begin_example 
    \img{Image.png}{Titre de l'image}{0.5}{0.5}
    @end_example
    @end
    \end{comment}
    
    \newcommand{\imgf}[4]{
    \begin{subfigure}{#4\textwidth}
        \includegraphics[scale=#3]{#1}
      %\caption{#2}
    \end{subfigure}
    }
    %################################################################%############################################################
%###### Package 'name' 
%###### This package contains ...
%###### Author  : Nicolas LE GUERROUE
%###### Contact : nicolasleguerroue@gmail.com
%############################################################
\RequirePackage{enumitem}
\RequirePackage{pifont}

%################################################################

\newcommand{\setTriangleList}{\renewcommand{\labelitemi}{$\blacktriangleright$}}
\newcommand{\setCircleList}{\renewcommand{\labelitemi}{$\circ$}}
\newcommand{\setBulletList}{\renewcommand{\labelitemi}{$\bullet$}}
\newcommand{\setDiamondList}{\renewcommand{\labelitemi}{$\diamond$}}

\newcommand{\Triangle}{$\blacktriangleright$}
\newcommand{\Circle}{$\circ$}
\newcommand{\Bullet}{$\bullet$}
%\newcommand{\Diamond}{$\diamond$}


\newenvironment{items}[2]
{      
        \begin{itemize}[font=\color{#1}, label=#2]
           
    }
    { 
        \end{itemize}

}%############################################################
%###### Package 'name' 
%###### This package contains ...
%###### Author  : Nicolas LE GUERROUE
%###### Contact : nicolasleguerroue@gmail.com
%############################################################
\tcbuselibrary{listings,breakable, skins}
%\RequirePackage{amsmath}

%################################################################

\newtcbox{\file}{enhanced, nobeforeafter,tcbox raise base,boxrule=0.4pt,top=0mm,bottom=0mm,
  right=0mm,left=4mm,arc=1pt,boxsep=2pt,before upper={\vphantom{dlg}},
  colframe=orange!50!black,coltext=orange!25!black,colback=orange!10!white,
  overlay={\begin{tcbclipinterior}\fill[orange!75!white] (frame.south west)
    rectangle node[text=white,font=\sffamily\bfseries\tiny,rotate=90] {FILE} ([xshift=4mm]frame.north west);\end{tcbclipinterior}}}

\newtcbox{\lib}{enhanced, nobeforeafter,tcbox raise base,boxrule=0.4pt,top=0mm,bottom=0mm,
  right=0mm,left=4mm,arc=1pt,boxsep=2pt,before upper={\vphantom{dlg}},
  colframe=green!50!black,coltext=green!25!black,colback=green!10!white,
  overlay={\begin{tcbclipinterior}\fill[green!75!green!50!white] (frame.south west)
    rectangle node[text=white,font=\sffamily\bfseries\tiny,rotate=90] {LIB} ([xshift=4mm]frame.north west);\end{tcbclipinterior}}}

\newtcbox{\dir}{enhanced, nobeforeafter,tcbox raise base,boxrule=0.4pt,top=0mm,bottom=0mm,
  right=0mm,left=4mm,arc=1pt,boxsep=2pt,before upper={\vphantom{dlg}},
  colframe=blue!50!black,coltext=blue!25!black,colback=blue!10!white,
  overlay={\begin{tcbclipinterior}\fill[blue!75!blue!50!white] (frame.south west)
    rectangle node[text=white,font=\sffamily\bfseries\tiny,rotate=90] {DIR} ([xshift=4mm]frame.north west);\end{tcbclipinterior}}}


\newtcbox{\shortcut}{enhanced, nobeforeafter,tcbox raise base,boxrule=0.4pt,top=0mm,bottom=0mm,
  right=0mm,left=4mm,arc=1pt,boxsep=2pt,before upper={\vphantom{dlg}},
  colframe=purple!50!black,coltext=purple!25!black,colback=purple!10!white,
  overlay={\begin{tcbclipinterior}\fill[purple!75!blue!50!white] (frame.south west)
    rectangle node[text=white,font=\sffamily\bfseries\tiny,rotate=90] {KEY} ([xshift=4mm]frame.north west);\end{tcbclipinterior}}}

\newtcbox{\link}{enhanced, nobeforeafter,tcbox raise base,boxrule=0.4pt,top=0mm,bottom=0mm,
  right=0mm,left=4mm,arc=1pt,boxsep=2pt,before upper={\vphantom{dlg}},
  colframe=purple!50!black,coltext=purple!25!black,colback=purple!10!white,
  overlay={\begin{tcbclipinterior}\fill[purple!75!blue!50!white] (frame.south west)
    rectangle node[text=white,font=\sffamily\bfseries\tiny,rotate=90] {URL} ([xshift=4mm]frame.north west);\end{tcbclipinterior}}}


\newtcbox{\bin}{enhanced, nobeforeafter,tcbox raise base,boxrule=0.4pt,top=0mm,bottom=0mm,
  right=0mm,left=4mm,arc=1pt,boxsep=2pt,before upper={\vphantom{dlg}},
  colframe=blue!50!black,coltext=blue!25!black,colback=blue!10!white,
  overlay={\begin{tcbclipinterior}\fill[blue!75!blue!50!white] (frame.south west)
    rectangle node[text=white,font=\sffamily\bfseries\tiny,rotate=90] {BIN} ([xshift=4mm]frame.north west);\end{tcbclipinterior}}}

\newtcbox{\hexa}{enhanced, nobeforeafter,tcbox raise base,boxrule=0.4pt,top=0mm,bottom=0mm,
  right=0mm,left=4mm,arc=1pt,boxsep=2pt,before upper={\vphantom{dlg}},
  colframe=blue!50!black,coltext=blue!25!black,colback=blue!10!white,
  overlay={\begin{tcbclipinterior}\fill[blue!75!blue!50!white] (frame.south west)
    rectangle node[text=white,font=\sffamily\bfseries\tiny,rotate=90] {HEX} ([xshift=4mm]frame.north west);\end{tcbclipinterior}}}



\newtcbox{\ugrey}{nobeforeafter,colframe=gray,colback=gray!10!white,boxrule=0.5pt,arc=2pt,
  boxsep=0pt,left=2pt,right=2pt,top=2pt,bottom=2pt,tcbox raise base}


\newtcbox{\ugreen}{nobeforeafter,colframe=white,colback=green!40!white,boxrule=0pt,arc=0pt,
  boxsep=0pt,left=1pt,right=1pt,top=1pt,bottom=1pt,tcbox raise base}

\newtcbox{\ublue}{nobeforeafter,colframe=white,colback=blue!10!white,boxrule=0pt,arc=0pt,
  boxsep=0pt,left=1pt,right=1pt,top=1pt,bottom=1pt,tcbox raise base}

\newtcbox{\uorange}{nobeforeafter,colframe=white,colback=orange!40!white,boxrule=0pt,arc=0pt,
  boxsep=0pt,left=1pt,right=1pt,top=1pt,bottom=1pt,tcbox raise base}

\newtcbox{\ured}{nobeforeafter,colframe=white,colback=orange!40!red,boxrule=0pt,arc=0pt,
  boxsep=0pt,left=1pt,right=1pt,top=1pt,bottom=1pt,tcbox raise base}

\newtcbox{\highlight}[1]{nobeforeafter,colframe=white,colback=#1,boxrule=0pt,arc=0pt,
  boxsep=0pt,left=1pt,right=1pt,top=1pt,bottom=1pt,tcbox raise base}%############################################################
%###### Package 'Layout' 
%###### This package contains some tools to set page layout or text
%###### Author  : Nicolas LE GUERROUE
%###### Contact : nicolasleguerroue@gmail.com
%############################################################
\RequirePackage{lmodern}
\RequirePackage[T1]{fontenc}
\RequirePackage[utf8]{inputenc}     %UTF-8 encoding
\RequirePackage{graphicx}           %Images
\RequirePackage{caption}            %légende
\RequirePackage{textcomp}           %special characters

\RequirePackage{lastpage}           %page counter
%\RequirePackage{fullpage}          %entire page
\RequirePackage{float}              %image floating
\RequirePackage{wrapfig}
\RequirePackage{subcaption}         %Subcaption
\RequirePackage{listings}           %new env such as Bash, Python
%\RequirePackage{tcolorbox}          %messageBox
\RequirePackage[many]{tcolorbox}
\RequirePackage{color}              %colors
\RequirePackage{geometry}
\RequirePackage{listings}           %new env such as Bash, Python
\RequirePackage{xcolor}             %define new colors
\RequirePackage{xparse}
\RequirePackage{amssymb,amsthm}     %math
\RequirePackage{multirow}
\RequirePackage{tabularx}           %use for csv file [table]

\RequirePackage{lipsum}  
\RequirePackage{fontawesome}

%################################################################
\begin{comment}
@begin
@command \bold
@des 
Cette commande permet de mettre le texte en gras
@sed
@input Texte à mettre en gras
@begin_example 
\bold{texte en gras}
@end_example
@end
\end{comment}

\renewcommand{\bold}[1]{\textbf{#1}}

%################################################################
\begin{comment}
@begin
@command \italic
@des 
Cette commande permet de mettre le texte en italique
@sed
@input Texte à mettre en italique
@begin_example 
\italic{texte en italique}
@end_example
@end
\end{comment}

\newcommand{\italic}[1]{\textit{#1}}

%################################################################
\begin{comment}
@begin
@command \ib
@des 
Cette commande permet de mettre le texte en italique et en gras
@sed
@input Texte à mettre en italique et gras
@begin_example 
\ib{texte en italique et gras}
@end_example
@end
\end{comment}

\newcommand{\ib}[1]{\textit{\textbf{#1}}}

%################################################################
\begin{comment}
@begin
@command \bi
@des 
Cette commande permet de mettre le texte en italique et en gras
@sed
@input Texte à mettre en italique et gras
@begin_example 
\bi{texte en italique et gras}
@end_example
@end
\end{comment}

\newcommand{\bi}[1]{\textit{\textbf{#1}}}


\begin{comment}
@begin
@command \n
@des 
Cette commande permet de faire un saut de ligne
@sed
@begin_example 
Text \n Next text
@end_example
@end
\end{comment}

\newcommand{\n}{\\}

%################################################################
\begin{comment}
@begin
@command \sn
@des 
Cette commande permet de faire un espace vertical
@sed
@begin_example 
Text \sn Next text
@end_example
@end
\end{comment}

\newcommand{\sn}{\vskip 0.5cm}

%################################################################


\newtheorem{question}{Question}
\newtheorem{reponse}{$>>>$}
\newtheorem{propriete}{Propriété}
\newtheorem{proposition}{Proposition}
\newtheorem{remarque}{Remarque}
\newtheorem{exemple}{Exemple}
\newtheorem{definition}{Definition}


%#######################################
\newcommand{\messageBox}[5]{
% 1: title
% 2: color frame
% 3: color bg
% 4: content
% 5: titlecolor
%\messageBox{Remarque}{green}{white}{Erreur 0xff58}{black}
%\messageBox{Installation}{gray}{white}{DE}{black}
%\messageBox{Avertissement}{orange}{white}{dede}{black}
%\messageBox{Erreur}{red}{white}{dede}{black}
 \begin{tcolorbox}[title=#1,
colframe=#2!80,
colback=#3!10,
coltitle=#5!100,  
]
#4
\end{tcolorbox}
}



%######################### PAGE STYLE



\newcommand{\setFullPage}{\RequirePackage{fullpage}}%############################################################
%###### Package 'name' 
%###### This package contains tools to use links, url and other
%###### Author  : Nicolas LE GUERROUE
%###### Contact : nicolasleguerroue@gmail.com
%############################################################
\RequirePackage{hyperref}           %Url


%################################################################
\begin{comment}
@begin
@command \setParameters
@des 
Cette commande permet de définir les propriétés du document PDF (auteur, titre...)
@sed
@input Titre du PDF
@input Auteur(s)
@input Sujet du fichier PDF (courte phrase)
@input Créateur du fichier PDF
@input Mots-clés (liste)
@input Couleurs des liens
@input Couleurs des citations dans la bibliographie
@input Couleurs des liens de fichier
@input Couleurs des liens externe
@begin_example 
\setParameters {Tutoriel Latex} {Nicolas LE GUERROUE} {Tutoriel Latex pour la mise en place des outils} {\author}{Latex}{green}{blue}{blue}
@end_example
@end
\end{comment}

\newcommand{\setParameters}[8]{
\hypersetup{
    bookmarks=true,         % show bookmarks bar?
    unicode=true,          % non-Latin characters in Acrobat’s bookmarks
    pdftoolbar=true,        % show Acrobat’s toolbar?
    pdfmenubar=true,        % show Acrobat’s menu?
    pdffitwindow=false,     % window fit to page when opened
    pdfstartview={1},    % fits the width of the page to the window
    pdftitle={#1},    % title
    pdfauthor={#2},     % author
    pdfsubject={#3},   % subject of the document
    pdfcreator={#4},   % creator of the document
    pdfproducer={#4}, % producer of the document
    pdfkeywords={#5}, % list of keywords
    pdfnewwindow=true,      % links in new PDF window
    colorlinks=true,       % false: boxed links; true: colored links
    linkcolor=black,          % color of internal links (change box color with linkbordercolor)
    citecolor=#6,        % color of links to bibliography
    filecolor=#7,         % color of file links
    urlcolor=#8,        % color of external links
}}%############################################################
%###### Package 'Maths' 
%###### This package contains some tools to set mathematic tools
%###### Author  : Nicolas LE GUERROUE
%###### Contact : nicolasleguerroue@gmail.com
%############################################################
%Vecteur à 3 composantes  
\newcommand{\evec}[3]{\left (\begin{array}{ccc} #1 \\ #2 \\ #3\end{array} \right )}
%Matrice à 3 composantes
\newcommand{\emat}[3]{\left [\begin{array}{ccc} #1 \\ #2 \\ #3\end{array} \right ]}
% \emat{a & b & c}{d & e & f}{g & h & i}%############################################################
%###### Package 'Titles' 
%###### This package contains some tools to set title color
%###### Author  : Nicolas LE GUERROUE
%###### Contact : nicolasleguerroue@gmail.com
%############################################################
\RequirePackage{pdfpages} 
%################################################################

%\includepdf[⟨options⟩]{⟨fichier⟩}\RequirePackage{color}              %colors
\RequirePackage{listings}           %new env such as Bash, Python
\RequirePackage{xcolor}             %define new colors
\RequirePackage{graphicx}             %define new colors
\RequirePackage{xparse}
\RequirePackage{amssymb,amsthm}     %math
\RequirePackage{multirow}
\RequirePackage{tabularx}           %use for csv file [table]
\RequirePackage{textcomp}           %special characters

%###############################################################
%### Couleurs programmation
\definecolor{green}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{purple}{rgb}{0.58,0,0.82}
\definecolor{bg}{rgb}{0.98,0.98,0.98}
%###############################################################
%### définition du style 'Python' [begin{Python}]
\lstdefinestyle{Python}{
    backgroundcolor=\color{bg},   
    commentstyle=\color{green},
    keywordstyle=\color{blue},
    numberstyle=\tiny\color{gray},
    stringstyle=\color{purple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=none,   %left, right, none 
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,  
    tabsize=2
}
\lstset{style=Python}
\lstset{literate=
  {á}{{\'a}}1 {é}{{\'e}}1 {í}{{\'i}}1 {ó}{{\'o}}1 {ú}{{\'u}}1
  {Á}{{\'A}}1 {É}{{\'E}}1 {Í}{{\'I}}1 {Ó}{{\'O}}1 {Ú}{{\'U}}1
  {à}{{\`a}}1 {è}{{\`e}}1 {ì}{{\`i}}1 {ò}{{\`o}}1 {ù}{{\`u}}1
  {À}{{\`A}}1 {È}{{\'E}}1 {Ì}{{\`I}}1 {Ò}{{\`O}}1 {Ù}{{\`U}}1
  {ä}{{\"a}}1 {ë}{{\"e}}1 {ï}{{\"i}}1 {ö}{{\"o}}1 {ü}{{\"u}}1
  {Ä}{{\"A}}1 {Ë}{{\"E}}1 {Ï}{{\"I}}1 {Ö}{{\"O}}1 {Ü}{{\"U}}1
  {â}{{\^a}}1 {ê}{{\^e}}1 {î}{{\^i}}1 {ô}{{\^o}}1 {û}{{\^u}}1
  {Â}{{\^A}}1 {Ê}{{\^E}}1 {Î}{{\^I}}1 {Ô}{{\^O}}1 {Û}{{\^U}}1
  {Ã}{{\~A}}1 {ã}{{\~a}}1 {Õ}{{\~O}}1 {õ}{{\~o}}1 {’}{{'}}1
  {œ}{{\oe}}1 {Œ}{{\OE}}1 {æ}{{\ae}}1 {Æ}{{\AE}}1 {ß}{{\ss}}1
  {ű}{{\H{u}}}1 {Ű}{{\H{U}}}1 {ő}{{\H{o}}}1 {Ő}{{\H{O}}}1
  {ç}{{\c c}}1 {Ç}{{\c C}}1 {ø}{{\o}}1 {å}{{\r a}}1 {Å}{{\r A}}1
  {€}{{\euro}}1 {£}{{\pounds}}1 {«}{{\guillemotleft}}1
  {»}{{\guillemotright}}1 {ñ}{{\~n}}1 {Ñ}{{\~N}}1 {¿}{{?`}}1
}
\lstnewenvironment{Python}[1]{\lstset{language=Python, title=#1}}{}
%###############################################################
%### Couleurs programmation
\definecolor{green}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{purple}{rgb}{0.58,0,0.82}
\definecolor{bg}{rgb}{0.98,0.98,0.98}
%###############################################################
%### définition du style 'Cpp' [begin{Cpp}]
\lstdefinestyle{Cpp}{
    basicstyle=\ttfamily,
    columns=fullflexible,
    keepspaces=true,
    upquote=true,
    showstringspaces=false,
    commentstyle=\color{olive},
    keywordstyle=\color{blue},
    identifierstyle=\color{violet},
    stringstyle=\color{purple},
    numbers=none,
    language=c,
}
\lstnewenvironment{Cpp}[1]{\lstset{style=Cpp, title=#1}}{}

%###############################################################
%### définition du style 'Bash' [begin{Bash}]
\lstdefinestyle{Bash}{
    basicstyle=\ttfamily,
    columns=fullflexible,
    keepspaces=true,
    upquote=true,
    frame=trBL, %frame=trBL, shadowbox, trrb
    %frameround=fttt,
    numbers=none,
    showstringspaces=false,
    commentstyle=\color{olive},
    keywordstyle=\color{blue},
    identifierstyle=\color{black},
    stringstyle=\color{gray},
    language=bash,
    morekeywords={sudo,apt-get,install, autoremove, update, upgrade}
}
\lstnewenvironment{Bash}[1]{\lstset{style=Bash, title=#1}}{}%############################################################
%###### Package 'Titles' 
%###### This package contains some tools to set title color
%###### Author  : Nicolas LE GUERROUE
%###### Contact : nicolasleguerroue@gmail.com
%############################################################
%\RequirePackage{titlesec} 
\RequirePackage[explicit]{titlesec} 
%################################################################

\@ifclassloaded{report}{
    \titleformat{\chapter}[display] {\fontsize{17pt}{12pt}\selectfont \bfseries}{\textcolor{red} {\chaptertitlename\ \thechapter: #1}}{20pt}{\Huge}
}

\titleformat{\section}[display] {\fontsize{17pt}{12pt}\selectfont \bfseries}{\textcolor{DarkBlue} {#1}}{20pt}{\Huge}
\titleformat{\subsection}[display] {\fontsize{15pt}{12pt}\selectfont \bfseries}{\textcolor{orange} {#1}}{20pt}{\large}
\titlespacing*{\section}{0pt}{20pt}{-30pt}
\titlespacing*{\subsection}{0pt}{20pt}{-20pt}
\documentclass[12pt]{report}  
%book, report, beamer, article
\usepackage[frenchb]{babel}     %french language
\usepackage{Utils/Utils}        %Utils package

%\usepackage[Lenny]{fncychap}   %Sonny, Lenny, Glenn, Conny, Rejne, Bjarne
%#############################################################
%#### Settings
%#############################################################
%#############################################################
%If you want to set on fullpage, change this bloc
%#############################################################
\geometry{hmargin=2.5cm,vmargin=2.5cm}
%#############################################################
%#############################################################
%If you want rename the chapter name, change the value of argument
%#############################################################
\setAliasChapter{Section}
%#############################################################
%#############################################################
%If you want to add presentation, modify the next bloc
%The firt line is about the header : 
% {left content}{center content}{right content}
%The second line is about the footer : 
% {left content}{center content}{right content}
%####
%to get the current chapter name, use \currentChapter command as content
%to get the current number page, use \currentPagecommand as content
\addPresentation
{Circuits de puissance} {} {\currentChapter}
{Club de Robotique et d'Electronique\\ Programmable de Ploemeur} {} {\currentPage}
%#############################################################
%Change the width of footer line and header line
%To delete it, set value to 0
\setHeaderLine{0.2}
\setFooterLine{0.2}

%#############################################################
%Change the name of the section "Nomenclature"
%To delete it, set value to 0
\renewcommand{\nomname}{Conventions}
%Setting up the parameter of PDF file as name, author...
\begin{comment}
@input Titre du PDF
@input Auteur(s)
@input Sujet du fichier PDF (courte phrase)
@input Créateur du fichier PDF
@input Producteur du fichier PDF
@input Mots-clés (liste)
@input Couleurs des liens
@input Couleurs des citations dans la bibliographie
@input Couleurs des liens de fichier
\end{comment}
\setParameters {Les Circuits de puissance} {Nicolas LE GUERROUE} {Transistors, MOSFETS, Bipolaires, relais} {Nicolas LE GUERROUÉ}{Circuits de puissance}{green}{blue}{blue}
  

\addtocounter{tocdepth}{1}



\titleformat{\chapter}
  {\gdef\chapterlabel{}
   \normalfont\sffamily\Huge\bfseries\scshape}
  {\gdef\chapterlabel{\thechapter)\ }}{0pt}
  {\begin{tikzpicture}[remember picture,overlay]
    \node[yshift=-2cm] at (current page.north west)
      {\begin{tikzpicture}[remember picture, overlay]
        \draw[fill=MediumBlue] (0,0) rectangle
          (\paperwidth,2cm);
        \node[anchor=east,xshift=.9\paperwidth,rectangle,
              rounded corners=20pt,inner sep=11pt,
              fill=white]
              {\color{black}#1};%\chapterlabel
          \node[anchor=west,yshift=1cm,xshift=2cm,inner sep=11pt,
              fill=MediumBlue]
              {\color{white}{\large Synthèse Latex}};%\chapterlabel
       \end{tikzpicture}
      };
   \end{tikzpicture}
  }
  \titlespacing*{\chapter}{0pt}{50pt}{-60pt}
\begin{document}
\setHeader{A}{A}{A}
\tableofcontents
\setcounter{page}{2}

\chapter{Introduction}

\addQuote{En dépit des perfectionnements électroniques, il advient parfois que la bonne vieille feuille imprimée soit le moyen d’information le plus pratique.}{Arthur Charles Clarke}


Pour certains projets plus évolués, on souhaite utiliser des composants tels que des moteurs ou des résistances (chauffage, ventilation).
Or, on constate rapidement que le branchement direct de ces éléments sur une carte Arduino va se révéler impossible. \\

En effet, la carte Arduino est prévu pour délivrer de \bold{faibles courants} et \bold{faibles tensions}.

Nous allons donc créer un circuit où la puissance et la commande sont dissociés.

\chapter{Les transistors bipolaires}

\section{Présentation}

Une des moyens pour créer notre circuit de puissance est le transistor bipolaire.
Ce composant possède trois broches : 

\begin{itemize}

  \item Le collecteur (C)
  \item la base (B)
  \item l'émetteur (E)

\end{itemize}

\img{\rootImages/bjt}{La représentation du transistor bipolaire}{0.2}

\section{Conventions}

Afin de simplifier les calculs par la suite, posons les normes suivantes : 

\begin{itemize}

  \item Le courant entrant dans le Collecteur est appelé $I_{C}$
  \item Le courant entrant dans la Base est appelé $I_{B}$
  \item Le courant sortant de l'émetteur est appelé $I_{E}$

  \item La tension entre la Base et l'Emetteur est appelée $V_{be}$
  \item La tension entre le Collecteur et l'Emetteur est appelée $V_{ce}$
\end{itemize}

\img{\rootImages/courants}{Conventions du transistor bipolaire}{0.15}


Les flèches au sein du transistor indiquent le sens de déplacement du courant sur les broches.

\subsection{Les familles de transistors bipolaires}

Les transistors bipolaires sont classés en deux catégories : 

\begin{itemize}

  \item Les transistors NPN\footnote{Le nom de ces familles provient du type de jonction utilisé en interne. Pour plus de rensiegnement, consulter les diodes et semi-conducteurs}
  \item Les transitors PNP

\end{itemize}

Le principe de fonctionnement est similaire entre ces deux familles, seul le branchement et le niveau de commande diffère.\\
Dans ce document, nous utiliserons essentiellement des transistors NPN car ces derniers utilisent des grandeurs positives.

\img{\rootImages/pnppnp}{Transistors NPN et PNP}{0.6}


\section{Les paramètres de sélection du transistor}

Notre transistor doit dans un premier temps répondre à deux contraintes : 

\begin{itemize}

  \item La tension admissible sur $V_{ce}$\footnote{Cette tension est indiquée ddans les documentations techniques} doit être supérieur à la tension d'alimentation de notre circuit.
  Concrètement, si notre circuit est alimenté en 48V mais que le transistor ne supporte pas plus de 30V, il va être détruit.
  \item Le transistor doit supporter un courant plus élevé que le courant maximal transitant dans notre circuit.
  Pour contrôler un moteur consommant 1 Ampère, je dois donc choisir un transistor pouvant contrôler au moins 1 Ampère.
\end{itemize}

Pour la suite de la présentation, on supposera que notre transistor a été dimensionné pour répondre à ces deux contraintes.


\section{Le principe}

Ce type de transistor fonctionne comme une vanne pour une canalisation. Il est possible de réguler le débit de la canalisation avec la vanne. \\

Le transistor bipolaire permet de contrôler un courant important avec un faible courant.\\

\img{\rootImages/barrage.png}{Le rôle du transistor}{0.3}.

Ici, notre transistor joue le rôle de la vanne et permet de bloquer le courant (électrons) ou bien de les laisser passer. \\


Le courant de l'élément à contrôler (moteur, résistance de puissance....) transite entre le collecteur et l'émetteur et le courant de commande passe par la base, comme l'illustre la figure suivante.\\

\img{\rootImages/courant_main.png}{Courant de commande et de puissance}{0.6}

La relation fondamentale reliant le courant de puissance et de commande est la suivante : 

$$ \boxed{ I_{C} = \beta \cdot I_{B} }$$

Le paramètre $\beta$, appelé \bold{gain du transistor}\footnote{le gain est sans dimension (unité) et est appelé \italic{$h_{fe}$} dans les documentations} est une caractéristique interne de notre transistor, c'est à dire qu'il dépend du type de transistor que nous choisissons.\\
Les courants $I_{C}, I_{B},I_{E}$ sont exprimés dans la même unité (Ampère, milliampères..) pour une formule homogène.\\

Les transistors de puissance possède des gains de l'ordre de la dizaine alors que les transistors de signal (faibles courants) ont un gain pouvant facilement atteindre 200 ou 300.

\messageBox{Remarque}{cyan}{white}{Plus notre $\beta$ est faible, plus il va falloir injecter un courant important dans notre base}{black}

\begin{question}
  Et que devient notre broche "\bold{Émetteur}" ?
\end{question} 

\begin{reponse}
  
  Notre émetteur est relié à la masse du circuit et permet de le fermer pour que les électrons puissent circuler.\\

  Le courant circulant dans l'émetteur est simplement la somme des courants entrant dans le transistor. \\
  d'où : $$ \boxed{ I_{E} = I_{B} + I_{C} }$$

  \end{reponse}



\section{Exemple}

On souhaite commander l'arrêt et la marche d'un moteur consommant au maximum 0.5A et alimenté avec une tension de 9V. \\
Nous choisissons un transistor permettant de commuter 1A (sécurité) avec $\beta=30$ \\

\begin{question}
Quel doit-être le courant injecté dans la base ?
\end{question}

\begin{reponse}
  On applique la formule précédent et on obtient : 

  $$  I_{B} = \frac{I_{C}}{\beta} = \frac{0.5}{30} = 16 mA $$

  \end{reponse}

 

    \section{Mise en pratique}

    \subsection{Branchements}

    Maintenant que nous connaissons les tensions et courants nécessaires à notre transistor et à notre moteur, nous allons le commander avec une carte Arduino. \\

    Tout d'abord, il convient de placer le moteur entre notre alimentation et le collecteur.\\
    

     \messageBox{Remarque}{cyan}{white}{{\color{red}Toutes les charges à contrôler avec ce type de transistor se placent entre l'alimentation et le collecteur.}}{black}

    Enfin, il ne nous reste plus qu'à relier une sortie numérique de l'Arduino vers notre base par l'intermédiaire d'une résistance.

    \bold{La résistance va servir à imposer le courant dans la base de notre transistor}.

    Nous obtenons donc le schéma suivant.

    \img{\rootImages/schema_pnp.png}{Branchement du transistor bipolaire}{0.4}

    \subsection{Dimensionnement de la résistance}

    On souhaite obtenir un courant de $16 mA$ dans notre base et on sait que l'Arduino délivre du $5V$ en sortie.\\

    Nous somme donc tentés de dire que $R_b = \frac{U_{arduino}}{ I_{B}} = \frac{5}{0.016} = 312 \Omega$ \footnote{On part de la loi d'Ohm qui dit que $U=R.I$}\\


    Hélas, il y a peu de chance que votre moteur tourne dans les conditions optimales.\\
    Il convient d'avoir à l'esprit que notre $\beta$ trouvé dans la documentation n'est que théorique et qu'il peut être en réalité inférieur.

    \messageBox{Remarque}{cyan}{white}{Une des conventions non officielles admet que pour de la commutation en \bold{Tout ou Rien}\footnote{Le transistor laisse passer tout le courant nécessaire ou rien du tout}, on divise la valeur théorique de notre $\beta$ par 2. \\Nous allons donc prendre donc un $\beta$ valant 15.}{black}
    
    On refait donc les calculs.

    $$  I_{B} = \frac{I_{C}}{\beta} = \frac{0.5}{15} = 32 mA $$

    Une dernière chose : les transistors bipolaires entraînent une chute de tension entre la base et l'émetteur ($V_{be}$).\\
    Cette chute de tension dépend de la technologie des transistors bipolaires : 

    \begin{itemize}

      \item $0.7V$ pour les transistors au silicium
      \item $0.3V$ pour les transistors au germanium
    \end{itemize}
    Dans l'extrême majorité des cas, on utilisera des transistors au silicium.

    La tension disponible aux bornes de la résistance est donc de $4.3V$ ($5-0.7$)

    D'où : 

    $$ \boxed{ R_{b} = \frac{U_{arduino}-V_{be}}{I_b} = \frac{4.3}{0.032} = 134 \Omega} $$

    \subsection{Exemple de programme Arduino}

    Voici un code permettant de faire tourner le moteur périodiquement pendant 5 secondes puis de l'arrêter pendant 5 secondes.

\begin{Cpp}{Code Arduino avec transistors NPN}
#define D8 8     //Broche 8 de l'Arduino

void setup() {

  pinMode(D8, OUTPUT); //Mise en sortie de la broche

}//End setup

void loop() {

  digitalWrite(D8, HIGH);     //Déclencher la rotation du moteur
  delay(5000);                //Délai de 5s
  digitalWrite(D8, LOW);      //Fin de la rotation du moteur
  delay(5000);                //Délai de 5s

}//End loop

\end{Cpp}

     \chapter{Les transistors MOSFET}

     \section{Présentation}

     Nous avons vu l'utilisation des transistors bipolaires. \\
     Ces derniers sont assez contraignants à mettre en oeuvre car ils sont commandés en courant.

     Nous allons utiliser cette fois-ci la technologie des MOSFET \footnote{MOSFET : Metal Oxide Semiconductor Field Effect Transistor = Transistor à effet de champ à structure métal-oxyde-semiconducteur} car ces derniers ont l'avantage d'être contrôlés en \bold{tension}.

     Ce composant possède trois broches : 
     
     \begin{itemize}
     
       \item Le drain (D)
       \item la porte (G)\footnote{'G' pour Gate}
       \item la source (S)
     
     \end{itemize}
     
     \img{\rootImages/mosfet.png}{La représentation du transistor MOSFET}{0.1}
     
     \section{Conventions}
     
     Afin de simplifier les calculs par la suite, posons également les normes suivantes : 
     
     \begin{itemize}
     
       \item Le courant entrant dans le Drain est appelé $I_{D}$
       \item Le courant entrant dans la Porte est appelé $I_{G}$
       \item Le courant sortant de la Source est appelé $I_{S}$

       \item La tension entre la Porte et la Source est appelée $V_{GS}$
       \item La tension entre le Drain et la Source est appelée $V_{DS}$
     \end{itemize}
     
     \subsection{Les familles de transistors MOSFET}

     Les transistors MOSFET sont classés en deux catégories : 
     
     \begin{itemize}
     
       \item Les transistors MOSFET à canal N\footnote{Le nom de ces familles provient du type de jonction utilisé en interne. Pour plus de rensiegnement, consulter les diodes et semi-conducteurs}
       \item Les transitors MOSFET à canal P
     
     \end{itemize}
     
     Le principe de fonctionnement est similaire entre ces deux familles, seul le branchement et le niveau de commande diffère.\\
     Dans ce document, nous utiliserons essentiellement des transistors MOSFET à canal N car ces derniers utilisent des grandeurs positives.
     
     \img{\rootImages/mos.png}{Transistors à canal N et P}{0.6}

     \section{Les paramètres de sélection du transistor}
     
     Les paramètres de sélection de nos transistors MOSFET sont identiques aux transistors bipolaires, c'est à dire :
     
     \begin{itemize}
     
       \item La tension admissible sur $V_{DS}$ du transistor
       \item Le courant admissible entre le Drain et la Source.
     \end{itemize}
     
     Pour la suite de la présentation, on supposera que notre transistor a été dimensionné pour répondre à ces deux contraintes.


     \section{Le principe}

     Ce type de transistor fonctionne comme les transistors bipolaires mais est commandé en tension et non en courant.

     Par analogie, le drain joue le rôle du collecteur, la source celui de l'émetteur et la porte celui de la base.
     Le courant de l'élément à contrôler (moteur, résistance de puissance....) transite entre le drain et la source et la tension de commande est aux bornes de la porte.\\
     
     Les transistors MOSFET deviennent passant\footnote{Le transistor laisse passer tout le courant autorisé.} lorsque la tension sur la porte dépasse une tension de déclenchement appelée $V_{GS_{th}}$.
     Cette valeur est généralement comprise entre $2$ et $4$ Volts.\footnote{Lorsque la tension $V_{GS}$ est inférieure à $V_{GS_{th}}$, $I_D$ vaut $K \cdot ( (V_{GS}-V_{th})\cdot V_{DS}-\frac{1}{2}V_{DS}^2)$ \\Cette relation montre que l'étude en amplification est plus complexe car non linéaire.}\\

     \bold{Lorsque cette tension $V_{GS_{th}}$ est atteinte, notre transistor peut être remplacé d'un point de vue électrique entre le drain et la source par une résistance de très faible valeur, appelée $R_{DS_{on}}$}

    \section{Comparaison avec les transistors bipolaires}

    Par nature, la porte du MOSFET est vue comme un condensateur. Le transistor ne consomme pas de courant, excepté pendant les commutations.\\
    Ainsi, le courant est nul dans la porte pour maintenir le moteur en marche alors que pour un bipolaire, il faut maintenir un courant dans la base.\\

    Les MOSFET sont donc plus économes en énergie que les bipolaires.\\
    De plus, ils peuvent généralement supporter des courants plus importants que les bipolaires.\\

    En revanche, en hautes fréquences, les MOSFET sont moins réactifs du fait de leur capacité en entrée.
     \section{Mise en pratique}

     Nous souhaitons faire tourner le même moteur que celui utilisé avec notre transistor bipolaire.\\
     Nous allons le commander avec une carte Arduino.

     \subsection{Branchements}

     Tout d'abord, il convient de placer le moteur entre notre alimentation et le drain.\\
     
 
    \messageBox{Remarque}{cyan}{white}{{\color{black}Toutes les charges à contrôler avec ce type de transistor se placent entre l'alimentation et le drain.}}{black}
 
     Enfin, il ne nous reste plus qu'à relier une sortie numérique de l'Arduino vers notre porte \bold{sans} résistance.
 
     Nous obtenons donc le schéma suivant.
 
     \img{\rootImages/schema_mosfet.png}{Branchement du transistor MOSFET}{0.45}
  
     \subsection{Exemple de programme Arduino}
 
     Voici un code permettant de faire tourner le moteur périodiquement pendant 5 secondes puis de l'arrêter pendant 5 secondes. Il s'agit du même code que pour le transistor bipolaire.
 
 \begin{Cpp}{Code Arduino avec MOSFET}
 #define D8 8     //GATE du transistor
 
 void setup() {
 
   pinMode(D8, OUTPUT); //Mise en sortie de la broche
 
 }//End setup
 
 void loop() {
 
   digitalWrite(D8, HIGH);    //déclenchement du moteur
   delay(5000);               //Délai de 5s
   digitalWrite(D8, LOW);     //arrêt du moteur
   delay(5000);               //Délai de 5s
 
 }//End loop
 
 \end{Cpp}

 \chapter{Conclusion}

 \section{Ce qu'il faut retenir}

 
 Nous avons à notre disposition tout un ensemble de technologies pour contrôler la partie puissance.

 Les transistors ne sont pas adaptés pour commuter une charge sur secteur (230V), cette partie sera donc réservée aux relais.\\
 En revanche, pour toutes les tensions continues, les transitors sont adaptés et prennent moins de place en encombrement.\\

 \section{Les fiches techniques}

 L'intégralité des informations disponibles pour un transistor sont disponibles dans un document complet appelé \bold{Datasheet}.

 Ce document détaille les broches, les caractéristiques électriques, propose des schémas d'exemples....\\

 Par exemple, voici quelques extraits de la documentation du transistors IRF520\footnote{Transitor de puissance} :

 \img{\rootImages/irf520.png}{Extrait n°1 du IRF520}{0.4}

 \img{\rootImages/rdson.png}{Extrait n°2 du IRF520}{0.5}

 On retrouve sur cette figure la valeur de $R_{DS_{on}}$ et de $V_{GS_{th}}$

\end{document}
%#############################################################
